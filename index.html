<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mr Perfect AI Screenshot Analyzer</title>
  <script src="https://cdn.jsdelivr.net/npm/tesseract.js@2.1.1/dist/tesseract.min.js"></script>
  <style>
    body {
      background-color: black;
      color: #00ff00;
      font-family: 'Courier New', monospace;
      text-align: center;
      padding: 20px;
    }
    h1 {
      font-size: 2rem;
      text-shadow: 0 0 10px #00ff00;
    }
    input[type="file"] {
      background: #111;
      border: 1px solid #00ff00;
      color: #00ff00;
      padding: 10px;
      margin: 10px;
    }
    button {
      background: #00ff00;
      color: black;
      padding: 10px 20px;
      margin-top: 10px;
      font-weight: bold;
      cursor: pointer;
      border-radius: 10px;
      box-shadow: 0 0 10px #00ff00;
    }
    pre {
      text-align: left;
      background: #111;
      padding: 15px;
      border-radius: 10px;
      border: 1px solid #00ff00;
      overflow-x: auto;
      white-space: pre-wrap;
      max-height: 400px;
      margin-top: 20px;
    }
    .prediction {
      margin-top: 20px;
      font-size: 1.2rem;
      color: #0f0;
      text-shadow: 0 0 5px #00ff00;
    }
    .sure { color: #00ff00; font-weight: bold; font-size: 1.4rem; }
    .risky { color: yellow; font-weight: bold; font-size: 1.2rem; }
  </style>
</head>
<body>

<h1>üì∏ Mr. Perfect Screenshot AI Predictor</h1>
<p>Upload WINGO result screenshot (like TashanWin)</p>
<input type="file" id="imageInput" accept="image/*"><br>
<button onclick="processImage()">üß† Analyze Screenshot</button>

<pre id="ocrResult">Waiting for screenshot...</pre>

<div class="prediction" id="aiPrediction"></div>

<script>
function processImage() {
  const imageInput = document.getElementById('imageInput');
  const file = imageInput.files[0];
  if (!file) return alert("Please upload an image first.");

  const reader = new FileReader();
  reader.onload = function () {
    Tesseract.recognize(reader.result, 'eng').then(({ data: { text } }) => {
      document.getElementById('ocrResult').innerText = text;
      parseText(text);
    });
  };
  reader.readAsDataURL(file);
}

function parseText(rawText) {
  const lines = rawText.split('\n').filter(line => line.trim().length > 5);
  const resultLines = lines.filter(line => line.match(/\d{18}/));
  
  const results = resultLines.map(line => {
    const parts = line.split(/\s+/);
    const period = parts[0];
    const number = parseInt(parts[1]);
    let bigSmall = number >= 5 ? 'Big' : 'Small';
    let color = getColor(number);
    return { period, number, bigSmall, color };
  });

  if (results.length < 5) {
    document.getElementById("aiPrediction").innerText = "‚ö†Ô∏è Not enough data found.";
    return;
  }

  const last = results[0];
  const numbers = results.map(r => r.number);

  // Prediction logic
  const bigCount = numbers.filter(n => n >= 5).length;
  const smallCount = numbers.filter(n => n < 5).length;
  const colorCounts = { red: 0, green: 0, violet: 0 };

  results.forEach(r => {
    if (r.color.includes("Red")) colorCounts.red++;
    if (r.color.includes("Green")) colorCounts.green++;
    if (r.color.includes("Violet")) colorCounts.violet++;
  });

  let predictSize = bigCount > smallCount ? 'Small' : 'Big';
  let predictColor = colorCounts.green > colorCounts.red ? 'Red' : 'Green';
  let confidence = 80 + Math.floor(Math.random() * 10);

  // Adjust for patterns
  if (results[0].bigSmall === results[1].bigSmall &&
      results[1].bigSmall === results[2].bigSmall) {
    predictSize = results[0].bigSmall === 'Big' ? 'Small' : 'Big';
    confidence += 5;
  }

  const nextPeriod = (parseInt(last.period) + 1).toString();

  let entryStatus = confidence >= 85 ? "üí• SURESHOT ENTRY" : "‚ö†Ô∏è Risky Entry";
  let predictionText = `
üß† Next Period: ${nextPeriod}
üéØ Prediction: ${predictSize} + ${predictColor}
Confidence: ${confidence}%
${confidence >= 85 ? 'üí• SURESHOT ENTRY' : '‚ö†Ô∏è RISK WARNING'}
`;

  document.getElementById("aiPrediction").innerText = predictionText;
}

function getColor(n) {
  switch(n) {
    case 0: return "Red + Violet";
    case 1: return "Green";
    case 2: return "Red";
    case 3: return "Green";
    case 4: return "Red";
    case 5: return "Green + Violet";
    case 6: return "Red";
    case 7: return "Green";
    case 8: return "Red";
    case 9: return "Green";
    default: return "Unknown";
  }
}
</script>

</body>
</html>
