<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tashan Win Prediction</title>
  <style>
    body { font-family: Arial; background: #f4f4f4; padding: 0; margin: 0; }
    iframe { width: 100%; height: 300px; border: none; }
    .container { padding: 20px; }
    textarea { width: 100%; height: 300px; }
    button { padding: 10px 20px; font-size: 16px; margin-top: 10px; }
    #result { background: white; padding: 20px; margin-top: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
  </style>
</head>
<body>

  <!-- Game Page -->
  <iframe src="https://www.tashanwin.com" title="Tashan Win"></iframe>

  <!-- Prediction Panel -->
  <div class="container">
    <h2>Prediction Engine</h2>
    <textarea id="inputData" placeholder="Paste your result data here..."></textarea><br>
    <button onclick="runPrediction()">Predict Next Period</button>

    <div id="result"></div>
  </div>

  <script>
    function parseData(data) {
      const lines = data.trim().split("\n");
      let results = [];

      for (let i = 0; i < lines.length; i += 3) {
        const period = lines[i].replace("*", "").trim();
        const number = parseInt(lines[i+1]);
        const size = lines[i+2].trim();
        if (!isNaN(number)) {
          results.push({ period, number, size });
        }
      }
      return results.reverse(); // Latest first
    }

    function predictNext(results) {
      const predictions = [];

      const numbers = results.map(r => r.number);
      const sizes = results.map(r => r.size);

      // Method 1: Most frequent number
      const freqMap = {};
      for (let n of numbers) freqMap[n] = (freqMap[n] || 0) + 1;
      const mostFreq = Object.entries(freqMap).sort((a,b) => b[1]-a[1])[0][0];
      predictions.push(parseInt(mostFreq));

      // Method 2: Least frequent number
      const leastFreq = Object.entries(freqMap).sort((a,b) => a[1]-b[1])[0][0];
      predictions.push(parseInt(leastFreq));

      // Method 3: Average +1 mod 10
      const avg = Math.round(numbers.reduce((a,b)=>a+b,0)/numbers.length);
      predictions.push((avg + 1) % 10);

      // Method 4: Previous number repeated (momentum)
      predictions.push(numbers[0]);

      // Method 5: If streak is long, switch size
      let streakSize = 1;
      for (let i = 1; i < sizes.length; i++) {
        if (sizes[i] === sizes[0]) streakSize++;
        else break;
      }
      const nextSize = sizes[0] === 'Big' && streakSize >= 3 ? 'Small' :
                       sizes[0] === 'Small' && streakSize >= 3 ? 'Big' : sizes[0];

      // More methods (simplified for now; logic can expand)
      predictions.push((numbers[0] + 2) % 10);
      predictions.push((numbers[1] + 3) % 10);
      predictions.push((numbers[0] + numbers[1]) % 10);
      predictions.push(Math.abs(numbers[0] - numbers[1]) % 10);
      predictions.push((numbers[2] + 1) % 10);
      predictions.push((9 - numbers[0]));
      predictions.push(numbers[1]);
      predictions.push((numbers[0] * 2) % 10);
      predictions.push((numbers[0] + 5) % 10);
      predictions.push((numbers[0] + numbers[1] + numbers[2]) % 10);
      predictions.push(((numbers[0] * 3) + numbers[1]) % 10);
      predictions.push((Math.floor(numbers[0]/2) + numbers[1]) % 10);
      predictions.push((numbers[0] + 7) % 10);
      predictions.push((numbers[0] + 9) % 10);
      predictions.push((numbers[0] + numbers[numbers.length-1]) % 10);

      const finalNumber = mode(predictions);
      const finalSize = finalNumber >= 5 ? 'Big' : 'Small';

      return { number: finalNumber, size: nextSize || finalSize };
    }

    function mode(arr) {
      const map = {};
      for (let x of arr) map[x] = (map[x] || 0) + 1;
      return parseInt(Object.entries(map).sort((a,b)=>b[1]-a[1])[0][0]);
    }

    function runPrediction() {
      const input = document.getElementById("inputData").value;
      const data = parseData(input);

      if (data.length < 10) {
        alert("Please enter at least 10 results.");
        return;
      }

      const prediction = predictNext(data);
      const nextPeriod = "*010" + (parseInt(data[0].period.replace("*010", "")) + 1);

      document.getElementById("result").innerHTML = `
        <h3>Prediction for ${nextPeriod}</h3>
        <p><strong>Number:</strong> ${prediction.number}</p>
        <p><strong>Size:</strong> ${prediction.size}</p>
      `;
    }
  </script>
</body>
</html>
