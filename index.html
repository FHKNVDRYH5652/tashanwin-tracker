<!-- Payment Screenshot Upload -->
<div id="uploadBox" style="margin-top:16px">
  <label>Upload Payment Screenshot:</label><br>
  <input type="file" id="ssInput" accept="image/*" onchange="checkScreenshot()">
  <p id="ssStatus" class="small" style="margin-top:6px;color:#ff8080"></p>
</div>

<script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
<script>
let planAmount = 200; // Example: चुने गए plan का amount (backend से set करना होगा)

function checkScreenshot(){
  let file = document.getElementById("ssInput").files[0];
  if(!file){ return; }

  document.getElementById("ssStatus").innerText = "Processing screenshot...";

  Tesseract.recognize(file,'eng').then(({ data:{ text } })=>{
      console.log("OCR Text:", text);

      // सिर्फ numbers निकालना
      let amtMatch = text.match(/₹?\s?(\d{2,6})/);
      if(amtMatch){
          let detectedAmount = parseInt(amtMatch[1]);
          console.log("Detected:", detectedAmount);

          if(detectedAmount === planAmount){
              document.getElementById("ssStatus").style.color="lime";
              document.getElementById("ssStatus").innerText = "✅ Payment Verified: ₹" + detectedAmount;
              // अब अगला step unlock कर सकते हैं
          } else {
              document.getElementById("ssStatus").style.color="red";
              document.getElementById("ssStatus").innerText = "❌ Wrong Amount! Expected ₹" + planAmount + " but found ₹" + detectedAmount;
          }
      } else {
          document.getElementById("ssStatus").innerText = "❌ Could not detect payment amount.";
      }
  });
}
</script>
