<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mr Perfect Pro - Big/Small Predictor</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      background: linear-gradient(to bottom right, #0f0c29, #302b63, #24243e);
      font-family: 'Segoe UI', sans-serif;
    }
    .hidden { display: none; }
    .fade-in { animation: fadeIn 0.5s ease-in-out; }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body class="text-white p-4">
  <div id="accessScreen" class="text-center fade-in">
    <h1 class="text-3xl font-bold mb-4">üîê Enter Access Key</h1>
    <input id="keyInput" type="text" placeholder="Enter Key" class="p-2 rounded bg-gray-800 text-white w-64 text-center" />
    <button onclick="unlockApp()" class="ml-4 px-4 py-2 bg-blue-600 rounded hover:bg-blue-700">Enter</button>
  </div>

  <div id="app" class="hidden fade-in">
    <h1 class="text-3xl font-bold text-center text-purple-400 mb-4">üéØ Mr Perfect Pro - Big/Small Predictor</h1>

    <div class="max-w-4xl mx-auto">
      <h2 class="text-xl mb-2">üî¢ Enter Last 10 Results</h2>
      <div id="inputs" class="grid grid-cols-2 md:grid-cols-5 gap-2 mb-4"></div>

      <div class="bg-gray-800 p-3 rounded mb-2">
        <p class="text-sm text-gray-300">üß© Trend Preview:</p>
        <div id="trendPreview" class="text-yellow-300 font-semibold"></div>
      </div>

      <div class="bg-gray-900 p-3 rounded mb-4">
        <p class="text-sm text-gray-300">üì¶ Trend Result:</p>
        <div id="trendResult" class="text-green-400 font-semibold"></div>
      </div>

      <button id="predictBtn" class="bg-purple-600 hover:bg-purple-700 w-full py-2 rounded">Predict</button>

      <div id="predictionOutput" class="text-center text-xl mt-4"></div>
      <div id="resultBtns" class="hidden flex justify-center gap-4 mt-4">
        <button onclick="confirmResult(true)" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded">‚úÖ Win</button>
        <button onclick="confirmResult(false)" class="bg-red-600 hover:bg-red-700 px-4 py-2 rounded">‚ùå Loss</button>
      </div>

      <div class="mt-4">
        <h3 class="font-bold text-lg mb-2">üß† Prediction Breakdown</h3>
        <div id="logicBox" class="grid grid-cols-2 md:grid-cols-5 gap-2"></div>
      </div>

      <div class="mt-6">
        <canvas id="chart" height="150"></canvas>
      </div>

      <div class="mt-6 text-center">
        <p id="stats" class="text-sm text-gray-300"></p>
      </div>
    </div>
  </div>

  <audio id="ding" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

  <script>
    const ACCESS_KEY = "mrperfectkey";
    const logicNames = ["Trend", "Pattern", "Reverse", "Mirror", "Skip", "Weighted", "Zigzag", "Repeat", "Majority", "Gap"];

    let predictionHistory = [];
    let lastPrediction = null;
    let locked = false;
    let wins = 0, losses = 0;

    const inputs = document.getElementById("inputs");
    const resultBtns = document.getElementById("resultBtns");
    const predictionOutput = document.getElementById("predictionOutput");
    const logicBox = document.getElementById("logicBox");
    const chart = document.getElementById("chart");
    const stats = document.getElementById("stats");
    const trendPreview = document.getElementById("trendPreview");
    const trendResult = document.getElementById("trendResult");

    function unlockApp() {
      const input = document.getElementById("keyInput").value;
      if (input === ACCESS_KEY) {
        document.getElementById("accessScreen").classList.add("hidden");
        document.getElementById("app").classList.remove("hidden");
        renderInputs();
      } else {
        alert("Wrong key!");
      }
    }

    function renderInputs() {
      for (let i = 0; i < 10; i++) {
        const select = document.createElement("select");
        select.className = "bg-gray-900 border border-purple-500 p-2 rounded text-center";
        select.innerHTML = '<option value="">--</option><option value="Big">Big</option><option value="Small">Small</option>';
        select.addEventListener("change", updateTrendDisplay);
        inputs.appendChild(select);
      }
    }

    function updateTrendDisplay() {
      const values = Array.from(inputs.querySelectorAll("select")).map(s => s.value);
      const filtered = values.filter(v => v);
      trendPreview.textContent = filtered.join(" ‚Üí ");
      trendResult.textContent = filtered.join(", ");
    }

    function analyze(name, vals) {
      switch (name) {
        case "Trend": return vals[9];
        case "Pattern": return vals[0] === vals[2] ? vals[0] : opposite(vals[9]);
        case "Reverse": return opposite(vals[9]);
        case "Mirror": return vals[8] === vals[6] ? vals[8] : vals[9];
        case "Skip": return vals[8] === vals[6] && vals[6] === vals[4] ? vals[8] : vals[9];
        case "Weighted": let c = count(vals); return c["Big"] >= c["Small"] ? "Big" : "Small";
        case "Zigzag": return vals[9] === vals[7] ? vals[9] : opposite(vals[9]);
        case "Repeat": return vals[9];
        case "Majority": let m = count(vals); return m["Big"] > m["Small"] ? "Big" : "Small";
        case "Gap": return vals[0] === vals[3] ? vals[0] : opposite(vals[9]);
        default: return "Big";
      }
    }

    function count(arr) {
      return arr.reduce((acc, cur) => (acc[cur] = (acc[cur] || 0) + 1, acc), {});
    }

    function opposite(v) {
      return v === "Big" ? "Small" : "Big";
    }

    function predict() {
      if (locked) return alert("Confirm previous prediction result first.");

      const values = Array.from(inputs.querySelectorAll("select")).map(s => s.value);
      if (values.includes("")) return alert("Fill all 10 Big/Small values.");

      updateTrendDisplay();

      const votes = logicNames.map(name => analyze(name, values));
      const counts = count(votes);
      const final = counts["Big"] > counts["Small"] ? "Big" : "Small";
      const confidence = Math.floor((counts[final] / votes.length) * 100);

      predictionOutput.innerHTML = `Prediction: <span class='text-${final === "Big" ? "green" : "red"}-400 font-bold'>${final}</span> (${confidence}%)`;
      document.getElementById("ding").play();

      logicBox.innerHTML = logicNames.map((l, i) => `<div class='p-2 bg-gray-800 rounded'><b>${l}</b><br/><span class='text-${votes[i]==="Big" ? "green" : "red"}-400'>${votes[i]}</span></div>`).join("");

      predictionHistory.push(confidence);
      lastPrediction = final;
      locked = true;
      resultBtns.classList.remove("hidden");

      drawChart();
    }

    function confirmResult(win) {
      if (win) wins++;
      else {
        losses++;
        logicNames.push("SmartAI" + Math.floor(Math.random()*100));
      }

      updateStats();
      resultBtns.classList.add("hidden");
      predictionOutput.innerHTML += ` <span class="text-sm text-gray-300">[${win ? "Win" : "Loss"}]</span>`;
      locked = false;
    }

    function updateStats() {
      const total = wins + losses;
      const acc = total ? Math.round((wins / total) * 100) : 0;
      stats.innerText = `Total: ${total} | Wins: ${wins} | Losses: ${losses} | Accuracy: ${acc}%`;
    }

    function drawChart() {
      new Chart(chart, {
        type: 'line',
        data: {
          labels: predictionHistory.map((_, i) => i + 1),
          datasets: [{
            label: 'Confidence %',
            data: predictionHistory,
            borderColor: '#a78bfa',
            backgroundColor: 'rgba(167, 139, 250, 0.2)',
            tension: 0.3
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { min: 0, max: 100, ticks: { color: 'white' } },
            x: { ticks: { color: 'white' } }
          },
          plugins: { legend: { labels: { color: 'white' } } }
        }
      });
    }

    document.getElementById("predictBtn").addEventListener("click", predict);
  </script>
</body>
</html>
